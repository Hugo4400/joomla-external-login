#!/usr/bin/env php
<?php

use Symfony\Component\Yaml\Yaml;

// Require Composer's autoloader
require __DIR__ . '/../vendor/autoload.php';

// Read config
$config = Yaml::parse(file_get_contents(__DIR__ . '/../configuration.yaml'));

// Create update xml file
$content = file_get_contents(__DIR__ . '/../src/server.xml.tpl');
$content = str_replace(
	array('@JOOMLAVERSION@', '@VERSION@', '@SERVER@'),
	array($config['joomlaversion'], $config['version'], $config['server']),
	$content
);

if (!file_exists(__DIR__ . '/../build'))
{
	mkdir(__DIR__ . '/../build');
}

file_put_contents(__DIR__ . '/../build/server-' . $config['shortversion'] . '.xml', $content);


